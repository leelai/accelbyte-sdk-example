import matches from 'validator/lib/matches.js';
import XRegExp from 'xregexp';
import { z } from 'zod';
import { CommonValidationErrorType } from './constant/errorType';

const ValidateRegexErrorType = z.enum([CommonValidationErrorType.enum.invalidFormat]);
const validateRegex = (value, regex, { allowUnicode = false } = {}) => {
  if (allowUnicode && !XRegExp(regex).test(value)) {
    return ValidateRegexErrorType.enum.invalidFormat;
  }
  if (!allowUnicode && !matches(value, regex)) {
    return ValidateRegexErrorType.enum.invalidFormat;
  }
  return null;
};

export { ValidateRegexErrorType, validateRegex };
//# sourceMappingURL=validateRegex.js.map
//# sourceMappingURL=validateRegex.js.map